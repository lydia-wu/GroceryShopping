<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="The Best Household Meal Plan - Track your 6-meal rotation with ease">
    <meta name="theme-color" content="#5D4037">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="brown-translucent">
    <title>Meal Planner Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components/slide-panel.css">
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="container header-content">
                <div>
                    <h1 class="header-title">The Best Household Meal Plan</h1>
                    <p class="header-subtitle">6-Meal Rotation Tracker</p>
                </div>
                <div class="header-actions">
                    <nav class="nav">
                        <button class="nav-btn active" data-view="dashboard">Dashboard</button>
                        <button class="nav-btn" data-view="meals">Meals</button>
                        <button class="nav-btn" data-view="shopping">Shopping</button>
                        <button class="nav-btn" data-view="analytics">Analytics</button>
                    </nav>
                    <div class="header-overflow-menu" id="header-overflow-menu">
                        <button class="btn btn-sm header-overflow-btn" id="header-overflow-btn" title="More options">&#x2026;</button>
                        <div class="overflow-dropdown" id="overflow-dropdown">
                            <label class="overflow-dropdown-item">
                                <input type="checkbox" id="edit-mode-toggle">
                                <span>Edit Mode</span>
                            </label>
                        </div>
                    </div>
                    <span class="header-version" id="version-display">v1.0.0</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Hero Section - Next Meal -->
                <section class="hero" id="hero-section">
                    <p class="hero-date" id="today-date">Loading...</p>
                    <h2 class="hero-title">NEXT UP: <span id="next-meal-name">Loading...</span></h2>
                    <p class="hero-subtitle" id="next-meal-details">Loading meal details...</p>
                    <div class="hero-meta">
                        <div class="hero-meta-item">
                            <span>Scheduled:</span>
                            <strong id="next-meal-date">--</strong>
                        </div>
                        <div class="hero-meta-item">
                            <span>Servings:</span>
                            <strong id="next-meal-servings">--</strong>
                        </div>
                        <div class="hero-meta-item">
                            <span>Est. Cost:</span>
                            <strong id="next-meal-cost">--</strong>
                        </div>
                        <div class="hero-meta-item">
                            <span>Prep + Cook:</span>
                            <strong id="next-meal-time">--</strong>
                        </div>
                    </div>
                </section>

                <!-- Rotation Timeline -->
                <section class="section">
                    <h3 class="section-title">Meal Rotation</h3>
                    <div class="rotation-timeline" id="rotation-timeline">
                        <!-- Populated by JS -->
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                        <div class="rotation-item loading-skeleton skeleton-card"></div>
                    </div>
                </section>

                <!-- Meal Cards Grid -->
                <section class="section" id="meals-section">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="section-title" style="margin-bottom:0;">All Meals</h3>
                        <div class="flex gap-2">
                            <button class="btn btn-outline btn-sm" id="manage-rotation-btn">Manage Rotation</button>
                            <button class="btn btn-primary btn-sm" id="log-cooking-btn">Log Cooking</button>
                        </div>
                    </div>

                    <!-- Tag Filter Bar -->
                    <div class="tag-filter-bar" id="tag-filter-bar">
                        <span class="filter-label">Filter by tag:</span>
                        <div id="tag-filter-chips">
                            <!-- Populated by JS -->
                        </div>
                        <div class="filter-mode-toggle">
                            <label>
                                <input type="checkbox" id="filter-mode-all"> Match ALL
                            </label>
                            <button class="clear-filters-btn" id="clear-tag-filters">Clear</button>
                        </div>
                    </div>

                    <div class="meals-grid" id="meals-grid">
                        <!-- Populated by JS -->
                        <div class="meal-card loading-skeleton skeleton-card"></div>
                        <div class="meal-card loading-skeleton skeleton-card"></div>
                        <div class="meal-card loading-skeleton skeleton-card"></div>
                    </div>
                </section>

                <!-- Charts Section -->
                <section class="section" id="charts-section">
                    <h3 class="section-title">Analytics</h3>
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h4 class="chart-title">Cost per Meal</h4>
                            <div class="chart-container">
                                <canvas id="cost-per-meal-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4 class="chart-title">Spending by Trip</h4>
                            <div class="chart-container">
                                <canvas id="spending-by-trip-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4 class="chart-title">Macros per Meal</h4>
                            <div class="chart-container">
                                <canvas id="macros-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4 class="chart-title">Store Breakdown</h4>
                            <div class="chart-container">
                                <canvas id="store-breakdown-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4 class="chart-title">Spending by Store per Trip</h4>
                            <div class="chart-container">
                                <canvas id="store-per-trip-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <h4 class="chart-title">Micronutrients</h4>
                            <div class="chart-container">
                                <canvas id="micronutrients-chart"></canvas>
                            </div>
                        </div>
                        <!-- Blood Panel Nutrition Chart (Feature 11) -->
                        <div class="chart-card chart-card-wide">
                            <div class="chart-header">
                                <h4 class="chart-title">Blood Panel Nutrition</h4>
                                <button class="btn btn-sm" id="nutrition-settings-btn" title="Settings">⚙️</button>
                            </div>

                            <!-- Meal Selection Checkboxes -->
                            <div class="blood-radar-controls">
                                <div class="meal-checkboxes" id="blood-radar-meal-checkboxes">
                                    <!-- Populated by JS -->
                                </div>
                                <div class="checkbox-actions">
                                    <button class="btn btn-xs" id="blood-radar-select-all">All</button>
                                    <button class="btn btn-xs" id="blood-radar-select-none">None</button>
                                </div>
                            </div>

                            <!-- Score + Chart -->
                            <div class="blood-radar-content">
                                <div class="nutrition-score-panel">
                                    <div class="score-circle" id="score-circle">
                                        <span class="score-value" id="score-value">--</span>
                                    </div>
                                    <div class="score-grade" id="score-grade">--</div>
                                    <button class="btn btn-xs btn-outline" id="show-score-breakdown">View breakdown</button>
                                </div>
                                <div class="blood-radar-wrapper">
                                    <canvas id="blood-panel-radar"></canvas>
                                </div>
                            </div>

                            <!-- Info Bar -->
                            <div class="nutrition-info-bar">
                                <div class="info-item">
                                    <span class="info-label">Avg Calories</span>
                                    <span class="info-value" id="avg-calories">--</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Avg Cost</span>
                                    <span class="info-value" id="avg-cost">--</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Anti-inflammatory</span>
                                    <span class="info-value" id="anti-inflammatory-score">--</span>
                                </div>
                                <div class="info-item highlight">
                                    <span class="info-label">Strong Nutrients</span>
                                    <span class="info-value" id="strong-nutrients">--</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Health Benefits Section (Feature 7) -->
                    <div class="chart-row" style="margin-top: 1.5rem;">
                        <div class="chart-card chart-card-full">
                            <div class="chart-header">
                                <h4 class="chart-title">Health Benefits by Category</h4>
                                <p class="chart-subtitle">12 health defense categories based on "Eat to Beat Disease", "The Obesity Code", and "How Not to Die"</p>
                            </div>
                            <div class="health-benefits-container">
                                <div class="health-radar-wrapper">
                                    <canvas id="health-benefits-radar"></canvas>
                                </div>
                                <div class="health-categories-legend" id="health-categories-legend">
                                    <!-- Populated by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Staples Tracker Section -->
                <section class="section" id="staples-section">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="section-title" style="margin-bottom:0;">Homemade Staples</h3>
                        <button class="btn btn-outline btn-sm" id="log-staple-btn">Log Production</button>
                    </div>
                    <div class="staples-grid" id="staples-grid">
                        <!-- Populated by JS -->
                    </div>
                </section>

                <!-- What's Fresh Now Section -->
                <section class="fresh-section" id="fresh-section">
                    <h3 class="fresh-title">
                        <span>What's Fresh Now</span>
                        <span id="fresh-month">- January</span>
                    </h3>
                    <div class="fresh-grid">
                        <div class="fresh-column">
                            <h4>Fruits</h4>
                            <ul class="fresh-list" id="fresh-fruits">
                                <!-- Populated by JS -->
                            </ul>
                        </div>
                        <div class="fresh-column">
                            <h4>Vegetables</h4>
                            <ul class="fresh-list" id="fresh-vegetables">
                                <!-- Populated by JS -->
                            </ul>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer style="text-align: center; padding: 2rem; color: var(--color-gray-500); font-size: var(--font-size-sm);">
            <p>The Best Household Meal Plan &bull; <span id="footer-version">v1.0.0</span></p>
            <p>Data from: MealCostCalculator.xlsx &bull; Google Sheets &bull; USDA FoodData Central</p>
        </footer>
    </div>

    <!-- Log Cooking Modal -->
    <div class="modal-backdrop" id="log-cooking-modal-backdrop">
        <div class="modal" id="log-cooking-modal">
            <div class="modal-header">
                <h3 class="modal-title">Log Cooking Session</h3>
                <button class="modal-close" id="close-log-cooking">&times;</button>
            </div>
            <div class="modal-body">
                <form id="log-cooking-form">
                    <div class="form-group">
                        <label class="form-label" for="log-meal-select">Meal</label>
                        <select class="form-select" id="log-meal-select" required>
                            <option value="">Select a meal...</option>
                            <!-- Populated by JS -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="log-date">Date Cooked</label>
                        <input type="date" class="form-input" id="log-date" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="log-servings">Servings Made</label>
                        <input type="number" class="form-input" id="log-servings" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="log-notes">Notes (optional)</label>
                        <textarea class="form-textarea" id="log-notes" placeholder="Any notes about this cooking session..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-log-cooking">Cancel</button>
                <button class="btn btn-primary" id="save-log-cooking">Save</button>
            </div>
        </div>
    </div>

    <!-- Nutrition Detail Modal -->
    <div class="modal-backdrop" id="nutrition-modal-backdrop">
        <div class="modal" id="nutrition-modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">Nutrition: <span id="nutrition-meal-name">--</span></h3>
                <button class="modal-close" id="close-nutrition">&times;</button>
            </div>
            <div class="modal-body">
                <p class="text-muted text-small mb-4">Per Serving (<span id="nutrition-serving-info">1 of 6</span>)</p>

                <!-- Macros Grid -->
                <div class="nutrition-section">
                    <h4 class="nutrition-section-title">Macros</h4>
                    <div class="nutrition-grid" id="nutrition-macros">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Vitamins -->
                <div class="nutrition-section">
                    <h4 class="nutrition-section-title">Vitamins</h4>
                    <div id="nutrition-vitamins">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Minerals -->
                <div class="nutrition-section">
                    <h4 class="nutrition-section-title">Minerals</h4>
                    <div id="nutrition-minerals">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Special Nutrients (Omega-3, etc.) -->
                <div class="nutrition-section">
                    <div id="nutrition-special">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Health Benefits -->
                <div class="nutrition-section">
                    <h4 class="nutrition-section-title">Health Benefits</h4>
                    <div id="nutrition-facts">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-nutrition-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Rotation Modal -->
    <div class="modal-backdrop" id="rotation-modal-backdrop">
        <div class="modal" id="rotation-modal">
            <div class="modal-header">
                <h3 class="modal-title">Manage Rotation (<span id="rotation-count">6</span> of 10 max)</h3>
                <button class="modal-close" id="close-rotation">&times;</button>
            </div>
            <div class="modal-body">
                <div id="rotation-list">
                    <!-- Populated by JS -->
                </div>
                <div class="mt-4 flex gap-2">
                    <button class="btn btn-primary" id="add-meal-btn">+ Add New Meal</button>
                    <button class="btn btn-outline" id="view-library-btn">View Library</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-rotation-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Shopping List Modal -->
    <div class="modal-backdrop" id="shopping-modal-backdrop">
        <div class="modal" id="shopping-modal" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">Shopping List Generator</h3>
                <button class="modal-close" id="close-shopping">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Select meals to shop for:</label>
                    <div id="shopping-meal-checkboxes" class="flex flex-wrap gap-2">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div id="shopping-list-output" class="shopping-list hidden">
                    <!-- Populated by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="copy-shopping-list">Copy to Clipboard</button>
                <button class="btn btn-primary" id="generate-shopping-list">Generate List</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Meal Modal -->
    <div class="modal-backdrop" id="meal-edit-modal-backdrop">
        <div class="modal" id="meal-edit-modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title" id="meal-edit-title">Add New Meal</h3>
                <button class="modal-close" id="close-meal-edit">&times;</button>
            </div>
            <div class="modal-body">
                <form id="meal-edit-form">
                    <div class="form-group">
                        <label class="form-label" for="meal-name-input">Meal Name *</label>
                        <input type="text" class="form-input" id="meal-name-input" required placeholder="e.g., Kale & Chicken Pasta">
                    </div>
                    <div class="flex gap-4">
                        <div class="form-group" style="flex:1;">
                            <label class="form-label" for="meal-servings-input">Servings *</label>
                            <input type="number" class="form-input" id="meal-servings-input" required min="1" max="20" placeholder="6">
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label class="form-label" for="meal-prep-time">Prep Time (min) *</label>
                            <input type="number" class="form-input" id="meal-prep-time" required min="0" placeholder="20">
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label class="form-label" for="meal-cook-time">Cook Time (min) *</label>
                            <input type="number" class="form-input" id="meal-cook-time" required min="0" placeholder="30">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="meal-ingredients-input">Ingredients * (one per line, with quantities)</label>
                        <textarea class="form-textarea" id="meal-ingredients-input" required placeholder="1 lb chicken breast&#10;2 bunches kale&#10;8 oz pasta..." style="min-height: 150px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="meal-instructions-input">Instructions *</label>
                        <textarea class="form-textarea" id="meal-instructions-input" required placeholder="Step-by-step cooking instructions..." style="min-height: 150px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="meal-sides-input">Serve With (optional, comma-separated)</label>
                        <input type="text" class="form-input" id="meal-sides-input" placeholder="e.g., Sourdough bread, Grapefruit">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-meal-edit">Cancel</button>
                <button class="btn btn-primary" id="save-meal-edit">Save Meal</button>
            </div>
        </div>
    </div>

    <!-- Log Staple Modal (Feature 4: Enhanced with detailed tracking) -->
    <div class="modal-backdrop" id="staple-modal-backdrop">
        <div class="modal" id="staple-modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Log Staple Production</h3>
                <button class="modal-close" id="close-staple">&times;</button>
            </div>
            <div class="modal-body">
                <form id="staple-form">
                    <div class="form-group">
                        <label class="form-label" for="staple-select">Item</label>
                        <select class="form-select" id="staple-select" required>
                            <option value="">Select item...</option>
                            <option value="sourdough">Sourdough Bread</option>
                            <option value="yogurt">Yogurt</option>
                            <option value="breadcrumbs">Breadcrumbs</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="staple-date">Production Date</label>
                        <input type="date" class="form-input" id="staple-date" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="staple-quantity">Quantity</label>
                        <input type="text" class="form-input" id="staple-quantity" required placeholder="e.g., 3 loaves, 6.5 pints">
                    </div>

                    <!-- Sourdough-specific fields (Feature 4) -->
                    <div id="sourdough-fields" class="staple-specific-fields" style="display: none;">
                        <hr style="margin: 1rem 0; border-color: var(--color-gray-200);">
                        <h5 style="margin-bottom: 0.75rem; color: var(--color-brown);">Flour Details</h5>
                        <div class="form-group">
                            <label class="form-label" for="flour-type">Flour Type</label>
                            <select class="form-select" id="flour-type">
                                <option value="">Select flour...</option>
                                <option value="ka_bread">King Arthur Bread Flour</option>
                                <option value="ka_ap">King Arthur All-Purpose</option>
                                <option value="brm_whole_wheat">Bob's Red Mill Whole Wheat</option>
                                <option value="brm_rye">Bob's Red Mill Rye</option>
                                <option value="wheat_scout66">Wheat Berries - Scout 66</option>
                                <option value="wheat_turkey_red">Wheat Berries - Turkey Red</option>
                                <option value="wheat_red_fife">Wheat Berries - Red Fife</option>
                                <option value="other">Other (specify in notes)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="flour-grams">Flour Amount (grams)</label>
                            <input type="number" class="form-input" id="flour-grams" placeholder="e.g., 500">
                        </div>
                    </div>

                    <!-- Yogurt-specific fields (Feature 4) -->
                    <div id="yogurt-fields" class="staple-specific-fields" style="display: none;">
                        <hr style="margin: 1rem 0; border-color: var(--color-gray-200);">
                        <h5 style="margin-bottom: 0.75rem; color: var(--color-brown);">Yogurt Details</h5>
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <div class="form-group">
                                <label class="form-label" for="milk-quantity">Milk (cups)</label>
                                <input type="number" class="form-input" id="milk-quantity" placeholder="e.g., 8" step="0.5">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="starter-type">Starter Type</label>
                                <select class="form-select" id="starter-type">
                                    <option value="">Select...</option>
                                    <option value="fage">FAGE Greek Yogurt</option>
                                    <option value="previous">Previous Batch</option>
                                    <option value="chobani">Chobani</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <div class="form-group">
                                <label class="form-label" for="starter-quantity">Starter (tbsp)</label>
                                <input type="number" class="form-input" id="starter-quantity" placeholder="e.g., 2" step="0.5">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="incubation-hours">Incubation (hours)</label>
                                <input type="number" class="form-input" id="incubation-hours" placeholder="e.g., 12" step="0.5">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="straining-hours">Straining Duration (hours)</label>
                            <input type="number" class="form-input" id="straining-hours" placeholder="e.g., 4" step="0.5">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="staple-notes">Notes (optional)</label>
                        <textarea class="form-textarea" id="staple-notes" placeholder="Any notes about this batch..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-staple">Cancel</button>
                <button class="btn btn-primary" id="save-staple">Save</button>
            </div>
        </div>
    </div>

    <!-- Meal Library Modal (Feature 16: Archive System) -->
    <div class="modal-backdrop" id="library-modal-backdrop">
        <div class="modal" id="library-modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Meal Library</h3>
                <button class="modal-close" id="close-library">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Archive Stats Summary -->
                <div id="archive-stats" class="archive-stats" style="display: none;">
                    <span class="archive-stat-item"><strong id="archive-total">0</strong> archived</span>
                </div>

                <!-- Search Bar -->
                <div class="archive-search" style="margin-bottom: 1rem;">
                    <input type="text"
                           class="form-input"
                           id="archive-search-input"
                           placeholder="Search by name, tag, or reason..."
                           style="width: 100%;">
                </div>

                <!-- Archived Meals List -->
                <div id="library-list">
                    <!-- Populated by JS -->
                    <div class="empty-state">
                        <div class="empty-state-icon">&#128218;</div>
                        <h4 class="empty-state-title">No Archived Meals</h4>
                        <p class="empty-state-text">Archived meals will appear here. You can restore them to your rotation at any time.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-library-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Archive Reason Modal (Feature 16) -->
    <div class="modal-backdrop" id="archive-reason-modal-backdrop">
        <div class="modal" id="archive-reason-modal" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Archive Meal</h3>
                <button class="modal-close" id="close-archive-reason">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 1rem;">Archiving: <strong id="archive-meal-name">--</strong></p>
                <div class="form-group">
                    <label class="form-label">Reason (optional)</label>
                    <select class="form-select" id="archive-reason-select">
                        <option value="">No reason</option>
                        <option value="seasonal">Seasonal - out of season</option>
                        <option value="tired">Tired of it for now</option>
                        <option value="expensive">Too expensive currently</option>
                        <option value="time">Takes too long to make</option>
                        <option value="kids">Kids don't like it</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group" id="archive-reason-custom-group" style="display: none;">
                    <label class="form-label">Custom reason</label>
                    <input type="text" class="form-input" id="archive-reason-custom" placeholder="Enter reason...">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-archive-reason">Cancel</button>
                <button class="btn btn-primary" id="confirm-archive">Archive Meal</button>
            </div>
        </div>
    </div>

    <!-- Tag Editor Modal -->
    <div class="modal-backdrop" id="tag-editor-modal-backdrop">
        <div class="modal" id="tag-editor-modal">
            <div class="modal-header">
                <h3 class="modal-title">Edit Tags: <span id="tag-editor-meal-name">--</span></h3>
                <button class="modal-close" id="close-tag-editor">&times;</button>
            </div>
            <div class="modal-body">
                <div class="tag-editor" id="tag-editor-content">
                    <!-- Populated by JS -->
                </div>

                <div class="add-tag-section">
                    <h5 style="margin-bottom: var(--space-2); font-size: var(--font-size-sm);">Create New Tag</h5>
                    <div class="add-tag-form">
                        <div class="form-group">
                            <input type="text" class="form-input" id="new-tag-name" placeholder="Tag name">
                        </div>
                        <div class="form-group">
                            <select class="form-select" id="new-tag-category">
                                <option value="dietary">Dietary</option>
                                <option value="protein">Protein</option>
                                <option value="cuisine">Cuisine</option>
                                <option value="effort">Effort</option>
                                <option value="season">Season</option>
                            </select>
                        </div>
                        <button class="btn btn-outline btn-sm" id="create-new-tag">+ Add Tag</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-tag-editor">Cancel</button>
                <button class="btn btn-primary" id="save-tags">Save Tags</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- External Libraries (loaded from CDN) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- App Scripts -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
